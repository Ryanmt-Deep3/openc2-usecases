# GitHub SBoM support

## Background

The comply-to-connect usescase has an early step of querying the new device requesting it's "Software Bill of Materials" (SBoM) and comparing to policy as part of acceptance process. SBoMs are also referred to as "software inventory". The process of understanding what software is on a device is also called "software transparency".

The DoD comply-to-connect use case can be found [here](uc-A-comply-to-connect.md). The sFractal comply-to-connect use case can be found [here](uc-sFractal-IoT-C2C.md).

More information on SBoMs can be found at [NTIA SBoM](https://www.ntia.gov/SBOM)
* [Framing Software Component Transparency: Establishing a Common Software Bill of Material (SBOM)](https://www.ntia.gov/files/ntia/publications/framingsbom_20191112.pdf). This resource defines SBOM concepts and related terms, offers a baseline of how software components are to be represented, and discusses the processes around SBOM creation. With terminology and a background of the NTIA process, it serves as a detailed introduction to SBOM.
* [Roles and Benefits for SBOM Across the Supply Chain](https://www.ntia.gov/files/ntia/publications/ntia_sbom_use_cases_roles_benefits-nov2019.pdf). This resource summarizes the benefits of having an SBOM from the perspective of those who make software, those who choose or buy software, and those who operate it. It characterizes the security, quality, efficiency, and other organizational benefits, as well as the potential for the broader ecosystem h across the supply chain.
* [Survey of Existing SBOM Formats and Standards](https://www.ntia.gov/files/ntia/publications/ntia_sbom_formats_and_standards_whitepaper_-_version_20191025.pdf). This resource summarizes existing standards, formats, and initiatives as they apply to identifying the external components and shared libraries used in the construction of software products for SBOMs, highlighting two key formats of SPDX and SWID. The group analyzed efforts already underway by other groups related to communicating this information in a machine-readable manner.
* [Healthcare Proof of Concept Report](https://www.ntia.gov/files/ntia/publications/ntia_sbom_healthcare_poc_report_2019_1001.pdf). This resource documents the successful execution and lessons learned of a proof-of-concept exercise led by medical device manufacturers (MDMs) and healthcare delivery organizations (HDOs). The exercise examined the feasibility of SBOMs being generated by MDMs and used by HDOs as part of operational and risk management approaches to medical devices at their hospitals.

The use cases for SBoM can be found in the "Roles and Benefits ..." document. The relation to the comply to connect use case is that any/all of security/license/compliance/high-assurance use cases in the document could apply to the policy in the plugfest comply to connect. For example one policy may be to sandbox any device that violates any of the following policies:
- any software components with CVE's with CVSS > 5
- any software components with CVE's greater than 90 days old regardless of CVSS
- software components have inconsistent licensing (eg conflict of a copyleft license with a commercial license)
- a non-compliant SBoM (e.g. only 'first-hop' instead of the 'complete' SBoM required by the FDA pre-market guidance)
- any software components with a pedigree to the DPRK

All of the above require comparing the returned SBoM with data stored in the querying system. It is proposed to include an 'SBoM' feature in the query:features command to obtain the SBoM.

## Command/Response

- action: query
- target: features : "sbom"
  * sbom not currently a feature in the 1.0 Language but proposed to be added
- args: "sbom_type" not currently an arg in the 1.0 Language but proposed to be added with the type consists of a list of acceptable SBoM formats for the return in priority order. Only one SBoM shall be returned if the consumer has the capability to return more than one format. An empty list means the consumer can choose the format to return
  * "sbom_type" = "swid", "sdpx", "cyclonedx"
- response: "sbom_type" (which one of "swid", "sdpx", "cyclonedx" from args sbom_type)
- response: "sbom_depth" not currently a response in the 1.0 Language but proposed to be added. sbom_depth is one of:
  * "complete" - all of the components, and all subcomponents recursively, are included
  * "unknown" - all components and subcomponents are attempted to be included but the software producer did not know the full SBoM of some subcomponents because they did not have SBoMs. So there is incomplete information on some components or subcomponents
  * "one-hop" - just the top level components. The user is expected to look up the subcomponents themselves. A more complete SBoM is preferred but one-hop is better than none
- response: "manifest" not currently a response in the 1.0 Language but proposed to be added. This is the actual SBoM in machine readable format

  Example JSON command:
```JSON
  {
    "action": "query",
    "target": {
      "features": ["sbom"]
      },
    "args": {
      "sbom_type": ["cyclonedx", "spdx", "swid"]
    }
  }
```
The above command requests the SBoM from the consumer. It will accept any of the "cyclonedx", "spdx", "swid" formats but prefers cyclonedx over spdx over swid.

An example reply might be:
```JSON
{
    "status": 200,
    "results": {
      "sbom_type" : "cyclonedx",
      "sbom_depth" : "one-hop",
      "manifest" : {
    <?xml version="1.0"?><bom serialNumber="9e253f92-4e1c-497e-8f87-50730d24f18a" xmlns="http://cyclonedx.org/schema/bom/1.1"><components><component type="library"><description>Nerves System BR - Buildroot based build platform for Nerves Systems</description><hashes><hash alg="SHA-256">e3fda6bc49f8e3662d37355aad88c0839296597c0b6f6653d21967db1890b038</hash></hashes><licenses><license><id>Apache-2.0</id></license><license><name>GPLv2</name></license></licenses><name>nerves_system_br</name><purl>pkg:hex/nerves_system_br@1.9.5</purl><version>1.9.5</version></component><component type="library"><description>Nerves - Create firmware for embedded devices like Raspberry Pi, BeagleBone Black, and more</description><hashes><hash alg="SHA-256">07079342db3a03d19694118a93f220359fbd94b6e174b98d1ea2709db9e81da9</hash></hashes><licenses><license><id>Apache-2.0</id></license></licenses><name>nerves</name><purl>pkg:hex/nerves@1.5.1</purl><version>1.5.1</version></component><component type="library"><description>Socket handling library for Elixir</description><hashes><hash alg="SHA-256">98a2ab20ce17f95fb512c5cadddba32b57273e0d2dba2d2e5f976c5969d0c632</hash></hashes><licenses><license><id>WTFPL</id></license></licenses><name>socket</name><purl>pkg:hex/socket@0.3.13</purl><version>0.3.13</version></component><component type="library"><description>Read and write to U-Boot environment blocks</description><hashes><hash alg="SHA-256">b01e3ec0973e99473234f27839e29e63b5b81eba6a136a18a78d049d4813d6c5</hash></hashes><licenses><license><id>Apache-2.0</id></license></licenses><name>uboot_env</name><purl>pkg:hex/uboot_env@0.1.1</purl><version>0.1.1</version></component><component type="library"><description>Nerves Toolchain CTNG - Toolchain Platform</description><hashes><hash alg="SHA-256">452f8589c1a58ac787477caab20a8cfc6671e345837ccc19beefe49ae35ba983</hash></hashes><licenses><license><id>Apache-2.0</id></license></licenses><name>nerves_toolchain_ctng</name><purl>pkg:hex/nerves_toolchain_ctng@1.6.0</purl><version>1.6.0</version></component><component type="library"><description>A ring buffer backend for Elixir Logger with IO streaming.</description><hashes><hash alg="SHA-256">b1baddc269099b2afe2ea3a87b8e2b71e57331c0000038ae55090068aac679db</hash></hashes><licenses><license><id>Apache-2.0</id></license></licenses><name>ring_logger</name><purl>pkg:hex/ring_logger@0.8.0</purl><version>0.8.0</version></component><component type="library"><description>Nerves System Linter - Lint Nerves System Defconfigs.</description><hashes><hash alg="SHA-256">84e0f63c8ac196b16b77608bbe7df66dcf352845c4e4fb394bffd2b572025413</hash></hashes><licenses><license><id>Apache-2.0</id></license></licenses><name>nerves_system_linter</name><purl>pkg:hex/nerves_system_linter@0.3.0</purl><version>0.3.0</version></component><component type="library"><description>DNS library for Elixir using `inet_dns` module.
  }
}
```
